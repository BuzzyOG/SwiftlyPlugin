package Commands;

import java.io.File;
import java.io.IOException;

import org.bukkit.Bukkit;
import org.bukkit.ChatColor;
import org.bukkit.command.Command;
import org.bukkit.command.CommandExecutor;
import org.bukkit.command.CommandSender;
import org.bukkit.configuration.file.FileConfiguration;
import org.bukkit.configuration.file.YamlConfiguration;
import org.bukkit.entity.Player;

import me.Chris.SwiftlyCrafted.Hub.main;

public class SwiftieCommand implements CommandExecutor {
	public String hub = ChatColor.BOLD + "«" + ChatColor.GREEN + "" + ChatColor.BOLD + "Swift" + ChatColor.RESET + "" + ChatColor.BOLD + "» ";
	private main plugin;
	public SwiftieCommand(main Plugin) {
		this.plugin = Plugin;
	}
	public boolean onCommand(CommandSender sender, Command cmd, String label,String[] args) {
		   if(cmd.getName().equalsIgnoreCase("Swifty")) {
			       if(args.length < 3) {
			    	   sender.sendMessage(hub + ChatColor.GREEN + "Not enough arguments!");
			    	   sender.sendMessage(hub + ChatColor.RED + "Correct form: /Swifty give/set/take player amount");
			       }
			       
			       else {
			    	   	try { 
			    	        Integer.parseInt(args[2]);
			    	    } catch(NumberFormatException e) {
			    	        sender.sendMessage(hub + ChatColor.GREEN + args[2] + ChatColor.YELLOW + " Is not a number!");
			    	        return false; 
			    	    }
			    	   	Player target = Bukkit.getServer().getPlayer(args[1]);
			    	   	
			    	    File playerFile = new File(this.plugin.getDataFolder() + File.separator + "players" + File.separator + target + ".yml");
			    		if(!playerFile.exists()){
			    		     try {
			    				playerFile.createNewFile();
			    			} catch (IOException e) {
			    				// TODO Auto-generated catch block
			    				e.printStackTrace();
			    			} // needs try catch block
			    		}
			    		FileConfiguration fc = YamlConfiguration.loadConfiguration(playerFile);
			    		fc.set("Swiftys", Integer.parseInt(args[2]));
			    		try {
			    			fc.save(playerFile);
			    			if(target instanceof Player) {
			    				target.sendMessage(hub + ChatColor.BLUE + target + ChatColor.RED + " Gained their coins!");
			    			}
			    		} catch (IOException e) {
			    			// TODO Auto-generated catch block
			    			e.printStackTrace();
			    		}
			   }
		   }
		   return false;
		}	
}
