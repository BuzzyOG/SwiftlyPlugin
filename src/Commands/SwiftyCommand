package Commands;

import java.io.File;
import java.io.IOException;

import org.bukkit.Bukkit;
import org.bukkit.ChatColor;
import org.bukkit.command.Command;
import org.bukkit.command.CommandExecutor;
import org.bukkit.command.CommandSender;
import org.bukkit.configuration.file.FileConfiguration;
import org.bukkit.configuration.file.YamlConfiguration;
import org.bukkit.entity.Player;

import me.Chris.SwiftlyCrafted.Hub.main;

public class SwiftieCommand implements CommandExecutor {
	main plugin;
	
	public SwiftiesCommand(main passedPlugin){
		this.plugin = passedPlugin;
	}

	public String hub =  "«" + ChatColor.GREEN + "" + ChatColor.BOLD + "Swifty" + ChatColor.RESET + "" + "» ";
	
	public boolean onCommand(CommandSender sender, Command cmd, String label,String[] args) {
		   if(cmd.getName().equalsIgnoreCase("swifty")) {
			       if(args.length < 3) {
			    	   sender.sendMessage(hub + ChatColor.RED + "Not enough arguments! Correct form: /swifty <add/set/remove> <player name> <amount>");
			       }
			       
			       else {
			    	   	try { 
			    	        Integer.parseInt(args[2]);
			    	    } catch(NumberFormatException e) {
			    	        sender.sendMessage(hub + ChatColor.RED + args[2] + ChatColor.YELLOW + " is not a number!");
			    	        return false; 
			    	    }
			    	   	Player target = Bukkit.getServer().getPlayer(args[1]);
			    	   	
			    	    File playerFile = new File(this.plugin.getDataFolder() + File.separator + "players" + File.separator + target + ".yml");
			    		if(!playerFile.exists()){
			    		     try {
			    				playerFile.createNewFile();
			    			} catch (IOException e) {
			    				// TODO Auto-generated catch block
			    				e.printStackTrace();
			    			} // needs try catch block
			    		}
			    		FileConfiguration fc = YamlConfiguration.loadConfiguration(playerFile);
			    		fc.set("swifties", Integer.parseInt(args[2]));
			    		try {
			    			fc.save(playerFile);
			    			if(target instanceof Player) {
			    				target.sendMessage(hub + ChatColor.GRAY + target.getName() + ChatColor.RED + " gained " + ChatColor.GRAY + args[2] + ChatColor.RED + " coins!");
			    			}
			    		} catch (IOException e) {
			    			// TODO Auto-generated catch block
			    			e.printStackTrace();
			    		}
			   }
		   }
		   return false;
		}	
}
